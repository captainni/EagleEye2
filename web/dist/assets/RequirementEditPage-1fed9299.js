import{d as x,m as n,j as g,c as d,e as m,a as s,w as y,f as b,A as w,y as h,E as r,r as N,o as i,b as q}from"./index-095c05da.js";import{N as k,_ as E}from"./axios-c1489369.js";import{d as R,_ as D}from"./defaultData-fb71e1fd.js";import{_ as B}from"./RequirementForm.vue_vue_type_script_setup_true_lang-8fa1bb52.js";import{g as j,u as C}from"./requirementService-f5232c39.js";import"./axiosInstance-4195a5ae.js";const I={class:"max-w-[1200px] mx-auto px-6 pt-24 pb-12"},M={class:"flex justify-between items-center mb-6"},P={key:0,class:"flex justify-center items-center py-20"},V={key:1,class:"bg-white rounded-lg shadow-sm p-8 text-center"},$=x({__name:"RequirementEditPage",setup(A){const c=w(),p=h(),f=n(R),a=n(null),l=n(!0),u=n(!1),_=async()=>{l.value=!0;try{const t=Number(c.params.id);if(isNaN(t))throw new Error("无效的需求ID");const e=await j(t);e.code===200&&e.data?a.value=e.data:(r.error(e.message||"获取需求详情失败"),a.value=null)}catch(t){r.error(t.message||"获取需求详情失败"),a.value=null}finally{l.value=!1}},v=async t=>{u.value=!0;try{const e=Number(c.params.id);if(isNaN(e))throw new Error("无效的需求ID");const o=await C(e,t);o.code===200?(r.success("需求更新成功"),p.push(`/requirement-detail/${e}`)):r.error(o.message||"更新失败")}catch(e){r.error(e.message||"更新操作失败")}finally{u.value=!1}};return g(()=>{_()}),(t,e)=>{const o=N("router-link");return i(),d("div",null,[m(k,{activeMenu:"/requirement-pool",user:f.value},null,8,["user"]),s("main",I,[s("div",M,[e[1]||(e[1]=s("h2",{class:"text-xl font-semibold text-gray-800"},"编辑需求",-1)),m(o,{to:"/requirement-pool",class:"!rounded-button px-3 py-1 border border-gray-300 text-gray-600 hover:border-primary hover:text-primary text-sm whitespace-nowrap"},{default:y(()=>e[0]||(e[0]=[s("i",{class:"fas fa-arrow-left mr-1"},null,-1),q(" 返回列表 ")])),_:1})]),l.value?(i(),d("div",P,e[2]||(e[2]=[s("i",{class:"fas fa-spinner fa-spin text-2xl text-primary mr-2"},null,-1),s("span",null,"加载需求数据...",-1)]))):a.value?(i(),b(B,{key:2,"initial-data":a.value,"is-edit":!0,onSubmit:v,loading:u.value},null,8,["initial-data","loading"])):(i(),d("div",V,e[3]||(e[3]=[s("p",{class:"text-lg text-gray-600"},"未找到需要编辑的需求信息",-1)])))]),m(D,{copyright:"© 2024 金融资讯智能跟踪平台. All rights reserved."})])}}});const G=E($,[["__scopeId","data-v-117d35f1"]]);export{G as default};
