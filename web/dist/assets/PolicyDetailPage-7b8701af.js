import{d as k,k as f,c as s,a as o,t as i,b as u,n as D,g as c,F as x,l as h,e as m,w as C,r as L,o as r,m as P,j as $,u as N,A}from"./index-095c05da.js";import{N as S}from"./axios-c1489369.js";import{_ as T,d as j}from"./defaultData-fb71e1fd.js";import{a as M}from"./policy-665470be.js";import"./request-211124dc.js";const B={class:"bg-white rounded-lg shadow-sm p-8"},F={class:"mb-6 pb-4 border-b border-gray-200"},H={class:"text-2xl font-semibold text-gray-800 mb-3"},I={class:"flex items-center text-sm text-gray-500 space-x-4"},V={key:0,class:"mb-8 p-4 bg-blue-50 border-l-4 border-primary rounded-r-md"},E={class:"list-disc list-inside space-y-1 text-sm text-gray-700"},O={key:0,class:"text-xs text-gray-500 pl-4"},R={key:1,class:"mb-8 p-4 bg-gray-50 border-l-4 border-gray-400 rounded-r-md"},U={class:"text-sm text-gray-700"},J={key:2,class:"mb-8 p-4 bg-orange-50 border-l-4 border-warning rounded-r-md"},q=["innerHTML"],z={key:3,class:"mb-6"},G=["innerHTML"],K={key:0,class:"mt-2 text-xs"},Q=["href"],W={class:"flex justify-end space-x-3 mt-8 pt-4 border-t border-gray-200"},X=k({__name:"PolicyDetail",props:{policy:{}},setup(v){const a=v,g=f(()=>{const e=a.policy.importance;return e?String(typeof e=="object"&&e!==null&&e.label||e):"未知"}),d=f(()=>{const e=a.policy.importance;if(!e)return"bg-gray-100 text-gray-600";let t,n;if(typeof e=="object"&&e!==null){const l=e;t=String(l.label||e).toLowerCase(),l.color&&(n=l.color)}else t=typeof e=="number"?e:String(e).toLowerCase();return n?`bg-${n}-100 text-${n}-600`:t==="高"||t==="high"||t===3?"bg-red-100 text-red-600":t==="中"||t==="medium"||t===2?"bg-yellow-100 text-yellow-600":t==="低"||t==="low"||t===1?"bg-green-100 text-green-600":"bg-gray-100 text-gray-600"}),y=f(()=>{console.log("计算 highlightedContent..."),console.log("原始 content:",a.policy.content),console.log("原始 keyPoints:",a.policy.keyPoints),console.log("keyPoints 类型:",typeof a.policy.keyPoints);const e=a.policy.content||"",t=a.policy.keyPoints;if(Array.isArray(t)&&t.length>0&&e){let n=e;return t.forEach(l=>{if(l){const p=l.replace(/[*+?^${}()|[\]\\]/g,"\\$&"),_=new RegExp(p,"gi");n=n.replace(_,w=>`<mark>${w}</mark>`)}}),console.log("高亮处理后的 content:",n),n}else return console.log("keyPoints 不可用或为空，返回原始 content"),e}),b=()=>{alert("需求已成功转化！")};return(e,t)=>{const n=L("router-link");return r(),s("div",B,[o("div",F,[o("h2",H,i(e.policy.title),1),o("div",I,[o("span",null,[t[0]||(t[0]=o("i",{class:"fas fa-landmark mr-1"},null,-1)),u(" 来源："+i(e.policy.source||"未知"),1)]),o("span",null,[t[1]||(t[1]=o("i",{class:"fas fa-calendar-alt mr-1"},null,-1)),u(" 发布日期："+i(e.policy.publishTime||"未知"),1)]),e.policy.importance?(r(),s("span",{key:0,class:D(["px-2 py-0.5 text-xs font-medium rounded-full",d.value])},i(g.value),3)):c("",!0),e.policy.areas&&e.policy.areas.length?(r(!0),s(x,{key:1},h(e.policy.areas,(l,p)=>(r(),s("span",{key:p,class:"px-2 py-0.5 text-xs font-medium rounded-full bg-blue-100 text-blue-600"},i(l),1))),128)):e.policy.tags&&e.policy.tags.length?(r(!0),s(x,{key:2},h(e.policy.tags,(l,p)=>(r(),s("span",{key:p,class:"px-2 py-0.5 text-xs font-medium rounded-full bg-blue-100 text-blue-600"},i(l),1))),128)):c("",!0)])]),e.policy.suggestions&&e.policy.suggestions.length?(r(),s("div",V,[t[2]||(t[2]=o("h4",{class:"text-base font-semibold text-primary mb-2"},"核心建议点：",-1)),o("ul",E,[(r(!0),s(x,null,h(e.policy.suggestions,(l,p)=>(r(),s("li",{key:l.id||p},[u(i(l.suggestion)+" ",1),l.reason?(r(),s("p",O,"理由："+i(l.reason),1)):c("",!0)]))),128))])])):c("",!0),e.policy.summary?(r(),s("div",R,[t[3]||(t[3]=o("h4",{class:"text-base font-semibold text-gray-600 mb-2"},"摘要：",-1)),o("p",U,i(e.policy.summary),1)])):c("",!0),e.policy.impactAnalysis?(r(),s("div",J,[t[4]||(t[4]=o("h4",{class:"text-base font-semibold text-warning mb-2"},"影响分析：",-1)),o("div",{class:"prose prose-sm max-w-none text-gray-700 leading-relaxed",innerHTML:e.policy.impactAnalysis},null,8,q)])):c("",!0),e.policy.content?(r(),s("div",z,[t[5]||(t[5]=o("h4",{class:"text-base font-semibold text-gray-700 mb-3"},"政策原文：",-1)),o("div",{class:"prose prose-sm max-w-none text-gray-600 leading-relaxed border border-gray-200 rounded-md p-4 max-h-96 overflow-y-auto",innerHTML:y.value},null,8,G),e.policy.sourceUrl?(r(),s("p",K,[o("a",{href:e.policy.sourceUrl,target:"_blank",class:"text-primary hover:underline"},"查看原文链接",8,Q)])):c("",!0)])):c("",!0),o("div",W,[m(n,{to:{name:"PolicyMonitoring"},class:"!rounded-button px-4 py-2 border border-gray-300 text-gray-600 hover:border-primary hover:text-primary text-sm whitespace-nowrap"},{default:C(()=>t[6]||(t[6]=[o("i",{class:"fas fa-arrow-left mr-1"},null,-1),u(" 返回列表 ")])),_:1}),o("button",{class:"!rounded-button px-4 py-2 bg-primary text-white text-sm whitespace-nowrap hover:bg-primary/90",onClick:b},t[7]||(t[7]=[o("i",{class:"fas fa-exchange-alt mr-1"},null,-1),u(" 转为需求 ")]))])])}}});const Y={class:"max-w-[1200px] mx-auto px-6 pt-24 pb-12"},Z={key:0},ee={key:1,class:"flex justify-center items-center py-20"},ne=k({__name:"PolicyDetailPage",setup(v){const a=A(),g=j,d=P(null),y=P(!0),b=async()=>{const e=a.params.id;if(console.log("[PolicyDetailPage] Loading detail for ID:",e),!e){console.error("[PolicyDetailPage] Failed to get ID from route."),y.value=!1;return}y.value=!0;try{console.log("[PolicyDetailPage] Calling getPolicyDetail API...");const t=await M(Number(e));console.log("[PolicyDetailPage] API returned data:",JSON.stringify(t,null,2)),d.value=t,console.log("[PolicyDetailPage] policy.value after assignment:",JSON.stringify(d.value,null,2))}catch(t){console.error("[PolicyDetailPage] Failed to fetch policy detail:",t),d.value=null}finally{y.value=!1,console.log("[PolicyDetailPage] Loading finished.")}};return $(()=>{b()}),(e,t)=>(r(),s("div",null,[m(S,{"active-menu":"/policy-monitoring",user:N(g)},null,8,["user"]),o("main",Y,[d.value?(r(),s("div",Z,[m(X,{policy:d.value},null,8,["policy"])])):(r(),s("div",ee,t[0]||(t[0]=[o("div",{class:"text-center"},[o("i",{class:"fas fa-spinner fa-spin text-primary text-3xl mb-4"}),o("p",{class:"text-gray-500"},"加载政策详情中...")],-1)])))]),m(T,{copyright:"© 2024 金融资讯智能跟踪平台. All rights reserved."})]))}});export{ne as default};
